<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3Dモデル表示テスト</title>
<style>
  body { margin:0; overflow:hidden; }
  #loading {
    position:absolute; top:50%; left:50%;
    transform: translate(-50%, -50%);
    font-family:sans-serif; color:#000;
  }
</style>
</head>
<body>
<div id="loading">モデル読み込み中…</div>

<!-- 非モジュール版 Three.js -->
<script src="https://cdn.jsdelivr.net/npm/three@0.150.0/build/three.min.js"></script>
<!-- 非モジュール版 GLTFLoader -->
<script src="https://cdn.jsdelivr.net/npm/three@0.150.0/examples/js/loaders/GLTFLoader.js"></script>

<script>
const loading = document.getElementById('loading');

// シーン
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xdddddd);

// カメラ
const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,1,3);

// レンダラー
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// 光源
scene.add(new THREE.AmbientLight(0xffffff,1));
const dirLight = new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(3,5,2);
scene.add(dirLight);

// GLTFLoaderでモデル読み込み
const loader = new THREE.GLTFLoader();
loader.load(
  './img/more.glb',  // index.html から見た相対パス
  function(gltf){
    const model = gltf.scene;
    model.position.set(0,-1,0);
    model.rotation.y = Math.PI;
    model.scale.set(1,1,1);
    scene.add(model);
    loading.style.display = 'none';
  },
  function(xhr){
    if(xhr.total) {
      loading.textContent = `モデル読み込み中… ${(xhr.loaded/xhr.total*100).toFixed(0)}%`;
    }
  },
  function(err){
    loading.textContent = 'モデル読み込みエラー';
    console.error(err);
  }
);

// 描画ループ
function animate(){
  requestAnimationFrame(animate);
  renderer.render(scene,camera);
}
animate();

// ウィンドウリサイズ対応
window.addEventListener('resize',()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
